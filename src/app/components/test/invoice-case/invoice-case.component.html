<div class="container mt-4">
  <h4 class="mb-3">Invoice Case Builder</h4>

  <!-- Bind the formGroup directive to the invoiceForm -->
  <form [formGroup]="invoiceForm">
    <!-- Step 1: Department and Case Type Selection -->
    <div class="row mb-3">
      <div class="col-md-4">
        <label class="form-label">Department</label>
        <select class="form-select" formControlName="department">
          <option value="">Select Department</option>
          <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
        </select>
      </div>

      <div class="col-md-4">
        <label class="form-label">Case Type</label>
        <select class="form-select" formControlName="caseType">
          <option value="">Select Case Type</option>
          <option *ngFor="let type of caseTypes" [value]="type">{{ type }}</option>
        </select>
      </div>
    </div>

    <!-- Step 2: Add New Option -->
    <div class="card mb-4">
      <div class="card-header">Add Option</div>
      <div class="card-body">
        <button class="btn btn-primary" (click)="addOption()">Add New Option</button>
      </div>
    </div>

    <!-- Step 3: Dynamic Options Table -->
    <div class="card">
      <div class="card-header">Options</div>
      <div class="table-responsive">
        <table class="table table-bordered mb-0">
          <thead class="table-light">
            <tr>
              <th>Label</th>
              <th>Value</th>
              <th>Base Price (₹)</th>
              <th>Alias</th>
              <th>Range</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let option of options.controls; let i = index" [formGroupName]="i">
              <td>
                <input type="text" class="form-control" formControlName="label" placeholder="Enter Label">
              </td>
              <td>
                <input type="text" class="form-control" formControlName="value" placeholder="Enter Value">
              </td>
              <td>
                <input type="number" class="form-control" formControlName="basePrice" placeholder="Enter Base Price">
              </td>
              <td>
                <input type="text" class="form-control" formControlName="alias" placeholder="Enter Alias">
              </td>
              <td>
                <input type="text" class="form-control" formControlName="rangeText" placeholder="Enter Range">
              </td>
              <td>
                <button class="btn btn-danger btn-sm" (click)="removeOption(i)">✖</button>
              </td>
            </tr>
            <tr *ngIf="options.length === 0">
              <td colspan="6" class="text-center text-muted">No options added yet</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="mt-3 text-end">
      <button class="btn btn-success" (click)="onSubmit()">Submit</button>
    </div>
  </form>
</div>
